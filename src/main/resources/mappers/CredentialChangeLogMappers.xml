<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.tool.passfort.mapper.CredentialChangeLogMapper">

    <!-- 创建日志 -->
    <insert id="createLog">
        INSERT INTO credential_change_log (history_id, user_id, operation_type, operation_time, description)
        VALUES (#{historyId}, #{userId}, #{operationType}, NOW(), #{description})
    </insert>

    <!-- 多参数查询 -->
    <select id="queryByUserIdAndOperationType" resultType="org.tool.passfort.model.CredentialChangeLog">
        SELECT * FROM credential_change_log
        <where>
            <if test="userId != null">
                AND user_id = #{userId}
            </if>
            <if test="operationType != null and operationType != ''">
                AND operation_type = #{operationType}
            </if>
        </where>
    </select>

    <!-- 查询某时间之前的操作 -->
    <select id="queryByTimeBefore" resultType="org.tool.passfort.model.CredentialChangeLog">
        SELECT * FROM credential_change_log
        WHERE user_id = #{userId}
        AND operation_time &lt; #{time}
    </select>

    <!-- 查询某时间之后的操作 -->
    <select id="queryByTimeAfter" resultType="org.tool.passfort.model.CredentialChangeLog">
        SELECT * FROM credential_change_log
        WHERE user_id = #{userId}
          AND operation_time &gt; #{time}
    </select>

</mapper>